<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="container">

    <h1>Dashboard</h1>

    <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –ø–æ—Å—ã–ª–∫–∏ -->
    <div class="card create-card">
        <form method="post" action="/dashboard/create">
            <input type="text" name="title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—ã–ª–∫–∏" required>
            <button type="submit">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—ã–ª–∫—É</button>
        </form>
    </div>

    {% for package in packages %}
    <div class="card status-{{ package.current_status }}">
        <div class="card-title">{{ package.title }}</div>
        <div class="track">{{ package.track_number }}</div>

        <!-- –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–∫+—Å—Å—ã–ª–∫–∞ -->
        <span class="copy-icon" onclick="copyTrack('{{ package.track_number }}','{{ package.deep_link }}')">üìã</span>

        <!-- –°—Ç–∞—Ç—É—Å –≤—ã–±–æ—Ä–∞ -->
        <form method="post" action="/dashboard/update">
            <input type="hidden" name="track_number" value="{{ package.track_number }}">
            <select name="status_id" onchange="this.form.submit()">
                {% for s in statuses %}
                <option value="{{ s.id }}" {% if s.id == package.current_status %}selected{% endif %}>
                    {{ s.name }}
                </option>
                {% endfor %}
            </select>
        </form>
    </div>
    {% endfor %}

</div>

<span class="copy-icon" onclick="copyTrack('{{ package.track_number }}','{{ package.deep_link }}')">üìã</span>
    
<script>
function copyTrack(track, link){
    navigator.clipboard.writeText(track + " | " + link)
    .then(()=>alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!"))
    .catch(()=>alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏"));
}
</script>

</body>
</html>
